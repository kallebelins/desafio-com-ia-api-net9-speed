# Mvp24Hours .NET Framework - Cursor Rules

## REGRA FUNDAMENTAL

Este projeto usa o **Mvp24Hours Framework** - um framework .NET completo com implementações próprias de:
- CQRS/Mediator (NÃO usa MediatR)
- Value Objects (Email, CPF, CNPJ, Money, etc.)
- Repository/UnitOfWork
- Pipeline/Behaviors
- E muito mais

**ANTES de implementar QUALQUER funcionalidade .NET, você DEVE:**

1. Chamar as ferramentas MCP `mvp24h_*` para verificar o que já existe
2. Usar as implementações do Mvp24Hours - NUNCA reinventar a roda
3. Seguir os padrões e namespaces documentados

---

## PROIBIÇÕES ABSOLUTAS

### ❌ NUNCA use MediatR
O Mvp24Hours tem implementação própria de CQRS/Mediator:
- Use `IMediatorCommand<T>`, `IMediatorQuery<T>` do namespace `Mvp24Hours.Infrastructure.Cqrs.Abstractions`
- ANTES de implementar CQRS: `mvp24h_cqrs_guide({ topic: "overview" })`

### ❌ NUNCA crie Value Objects que já existem
O Mvp24Hours já tem implementados no namespace `Mvp24Hours.Core.ValueObjects`:
- `Email` - Email com validação
- `Cpf` - CPF brasileiro com validação
- `Cnpj` - CNPJ brasileiro com validação
- `Money` - Valor monetário com moeda
- `Address` - Endereço completo
- `DateRange` - Range de datas
- `Percentage` - Porcentagem
- `PhoneNumber` - Telefone internacional

ANTES de criar VOs: `mvp24h_core_patterns({ topic: "value-objects" })`

### ❌ NUNCA crie Repository/UnitOfWork do zero
Use `IRepositoryAsync<T>`, `IUnitOfWorkAsync` do Mvp24Hours.
ANTES: `mvp24h_database_advisor({ patterns: ["repository", "unit-of-work"] })`

---

## FLUXO OBRIGATÓRIO PARA IMPLEMENTAÇÃO

### Para CQRS/Mediator:
```
1. mvp24h_cqrs_guide({ topic: "overview" })
2. mvp24h_cqrs_guide({ topic: "commands" }) ou ({ topic: "queries" })
3. mvp24h_cqrs_guide({ topic: "behaviors" })
```

### Para Entidades:
```
1. mvp24h_core_patterns({ topic: "entity-interfaces" })
2. Usar EntityBase<T>, IEntityLog do Mvp24Hours
```

### Para Value Objects:
```
1. mvp24h_core_patterns({ topic: "value-objects" })
2. VERIFICAR se já existe antes de criar
3. Se precisar criar novo, estender BaseVO
```

### Para Banco de Dados:
```
1. mvp24h_database_advisor({ provider: "postgresql" }) # ou outro
2. Usar IRepositoryAsync<T>, IUnitOfWorkAsync
```

### Para Arquitetura Completa:
```
1. mvp24h_build_context({ architecture: "cqrs", resources: ["database"] })
2. Seguir o checklist retornado
```

---

## NAMESPACES DO MVP24HOURS

| Componente | Namespace |
|------------|-----------|
| Core (VOs, Guards) | `Mvp24Hours.Core` |
| Value Objects | `Mvp24Hours.Core.ValueObjects` |
| Entidades | `Mvp24Hours.Core.Entities` |
| Contratos | `Mvp24Hours.Core.Contract.*` |
| CQRS/Mediator | `Mvp24Hours.Infrastructure.Cqrs` |
| Commands/Queries | `Mvp24Hours.Infrastructure.Cqrs.Abstractions` |
| Behaviors | `Mvp24Hours.Infrastructure.Cqrs.Behaviors` |
| EF Core | `Mvp24Hours.Infrastructure.Data.EFCore` |
| MongoDB | `Mvp24Hours.Infrastructure.Data.MongoDb` |
| RabbitMQ | `Mvp24Hours.Infrastructure.RabbitMQ` |
| WebAPI | `Mvp24Hours.WebAPI` |

---

## EXEMPLOS DE USO CORRETO

### Command CQRS (CORRETO)
```csharp
using Mvp24Hours.Infrastructure.Cqrs.Abstractions;

public record CreateCustomerCommand(string Name, string Email) 
    : IMediatorCommand<CustomerDto>;

public class CreateCustomerCommandHandler 
    : IMediatorCommandHandler<CreateCustomerCommand, CustomerDto>
{
    // ...
}
```

### Value Object Email (CORRETO)
```csharp
using Mvp24Hours.Core.ValueObjects;

// Usar o VO pronto:
var email = Email.Create("user@example.com");
```

### Repository (CORRETO)
```csharp
using Mvp24Hours.Core.Contract.Data;

public class CustomerHandler
{
    private readonly IRepositoryAsync<Customer> _repository;
    private readonly IUnitOfWorkAsync _unitOfWork;
}
```

---

## FERRAMENTAS MCP DISPONÍVEIS

| Ferramenta | Quando Usar |
|------------|-------------|
| `mvp24h_build_context` | Início de projeto/arquitetura |
| `mvp24h_cqrs_guide` | Implementar CQRS/Mediator |
| `mvp24h_core_patterns` | VOs, Guards, Entidades |
| `mvp24h_database_advisor` | Configurar banco de dados |
| `mvp24h_get_template` | Obter templates de código |
| `mvp24h_architecture_advisor` | Escolher arquitetura |
| `mvp24h_observability_setup` | Configurar logs/traces |
| `mvp24h_messaging_patterns` | RabbitMQ |
| `mvp24h_infrastructure_guide` | Pipeline, Cache, CronJob |

---

## CHECKLIST ANTES DE IMPLEMENTAR

- [ ] Chamei a ferramenta MCP apropriada?
- [ ] Verifiquei se o componente já existe no framework?
- [ ] Estou usando os namespaces corretos do Mvp24Hours?
- [ ] NÃO estou usando MediatR?
- [ ] NÃO estou criando VOs que já existem (Email, CPF, etc.)?
